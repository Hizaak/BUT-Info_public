import pandas as pd
import pyodbc
cnxn = pyodbc.connect("DSN=lakartxela")
import matplotlib.pyplot as plt
cursor = cnxn.cursor()


sql_query = pd.read_sql_query ('''SELECT count(*)/11 as nb,hour(date) as heure from Informmations where `commentaire de la date` is not null group by hour(date)
                               ''',cnxn)


df1 = pd.DataFrame(sql_query)

sql_query = pd.read_sql_query ('''SELECT count(*)/(365-11)as nb ,hour(date) as heure from Informmations where `commentaire de la date` is null group by hour(date)
                               ''',cnxn)


df2 = pd.DataFrame(sql_query)

fig = plt.figure()

for frame in [df1, df2]:
    plt.plot(frame['heure'], frame['nb'])
plt.xticks([x for x in range(0,24)])
for i in range(24): 
    plt.vlines(x=i, ymin=0, ymax=9, colors='#DBDBDB', lw=0.7, label='vline_single - partial height')
for i in range(0,9,2): 
    plt.hlines(y=i, xmin=0, xmax=24, colors='#DBDBDB', lw=0.7, label='hline_single - partial height')


#plt.show()





param=['Jour férié : Fête Nationale','Jour férié : Noël']
commande_incrayable=f"""SELECT hour(date) as Heure, COUNT(*)/{len(param)} as nb from Informmations where `commentaire de la date` in ({param}) GROUP BY HOUR(date)"""
sql_query = pd.read_sql_query (commande_incrayable,cnxn)
df3 = pd.DataFrame(sql_query)
print(df3)